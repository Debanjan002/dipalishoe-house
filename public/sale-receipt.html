<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sale Receipt - 40mm Thermal Printer</title>
    <style>
        /* 40mm Thermal Printer Optimized Styles */
        body { 
            font-family: 'Inter', 'Roboto', Arial, sans-serif; 
            font-size: 8px; 
            margin: 0; 
            padding: 5px; 
            width: 40mm;
            line-height: 1.3;
            color: #000;
            background: white;
        }
        
        .center { text-align: center; }
        .left { text-align: left; }
        .right { text-align: right; }
        .bold { font-weight: bold; }
        
        .line { 
            border-bottom: 1px dashed #000; 
            margin: 3px 0; 
        }
        
        .double-line {
            border-bottom: 2px solid #000;
            margin: 3px 0;
        }
        
        table { 
            width: 100%; 
            font-size: 7px;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 1px 2px;
            vertical-align: top;
        }
        
        .header { 
            font-size: 12px; 
            font-weight: bold; 
            margin-bottom: 3px;
            background: linear-gradient(135deg, #3B82F6, #1E40AF);
            color: white;
            padding: 5px;
            border-radius: 3px;
        }
        
        .sub-header {
            font-size: 7px;
            margin-bottom: 2px;
        }
        
        .footer { 
            font-size: 7px; 
            margin-top: 5px;
        }
        
        .footer-image { 
            text-align: center; 
            margin: 5px 0; 
        }
        
        .small { font-size: 6px; }
        .medium { font-size: 8px; }
        .large { font-size: 10px; }
        
        .item-row {
            border-bottom: 1px dotted #ccc;
        }
        
        .total-section {
            margin-top: 5px;
            padding-top: 3px;
            border-top: 1px solid #000;
        }
        
        .discount-text {
            color: #10B981;
            font-weight: bold;
        }
        
        .gst-breakdown {
            font-size: 6px;
            color: #555;
        }
        
        /* Print specific styles */
        @media print {
            body {
                width: 40mm;
                margin: 0;
                padding: 2px;
            }
            
            .no-print {
                display: none;
            }
        }
        
        /* Responsive font sizes for different paper widths */
        @media (max-width: 45mm) {
            body { font-size: 7px; }
            .header { font-size: 10px; }
            table { font-size: 6px; }
        }
        
        @media (min-width: 58mm) {
            body { 
                font-size: 9px; 
                width: 58mm;
            }
            .header { font-size: 14px; }
            table { font-size: 8px; }
        }
        
        @media (min-width: 80mm) {
            body { 
                font-size: 10px; 
                width: 80mm;
                padding: 8px;
            }
            .header { font-size: 16px; }
            table { font-size: 9px; }
        }
    </style>
</head>
<body>
    <!-- Shop Header -->
    <div class="center">
        <div class="header" id="shop-name">SHARMA SHOE PALACE</div>
        <div class="sub-header" id="shop-address">Shop No. 15, Gandhi Market<br>Connaught Place, New Delhi - 110001</div>
        <div class="sub-header" id="shop-contact">Ph: +91 98765 43210</div>
        <div class="sub-header" id="shop-email">Email: info@sharmashoes.com</div>
        <div class="sub-header" id="shop-gst">GSTIN: 07AABCS1234F1Z5</div>
        <div class="line"></div>
        <div class="bold large">SALE RECEIPT</div>
    </div>

    <!-- Bill Details -->
    <div class="left sub-header">
        <div>Bill No: <span id="bill-number">INV123456</span></div>
        <div>Date: <span id="bill-date">01/01/2024 12:00 PM</span></div>
        <div>Cashier: <span id="cashier-name">Admin</span></div>
    </div>
    <div class="line"></div>

    <!-- Items Table -->
    <table>
        <thead>
            <tr>
                <th style="text-align: left; width: 50%;">Item</th>
                <th style="text-align: center; width: 15%;">Qty</th>
                <th style="text-align: right; width: 17%;">Rate</th>
                <th style="text-align: right; width: 18%;">Amt</th>
            </tr>
        </thead>
        <tbody id="items-list">
            <!-- Items will be populated here -->
        </tbody>
    </table>
    <div class="line"></div>

    <!-- Totals Section -->
    <div class="total-section">
        <table>
            <tr>
                <td class="sub-header">Subtotal:</td>
                <td class="right sub-header" id="subtotal">₹0.00</td>
            </tr>
            <tr id="total-discount-row" style="display: none;">
                <td class="sub-header">Total Discount:</td>
                <td class="right sub-header discount-text" id="total-discount">-₹0.00</td>
            </tr>
            <tr>
                <td class="sub-header">After Discount:</td>
                <td class="right sub-header" id="after-discount">₹0.00</td>
            </tr>
            <tr class="gst-breakdown">
                <td class="sub-header">CGST (<span id="cgst-rate">9</span>%):</td>
                <td class="right sub-header" id="cgst-amount">₹0.00</td>
            </tr>
            <tr class="gst-breakdown">
                <td class="sub-header">SGST (<span id="sgst-rate">9</span>%):</td>
                <td class="right sub-header" id="sgst-amount">₹0.00</td>
            </tr>
            <tr class="double-line">
                <td class="medium bold">TOTAL:</td>
                <td class="right medium bold" id="final-total">₹0.00</td>
            </tr>
            <tr>
                <td class="sub-header">Paid (<span id="payment-method">Cash</span>):</td>
                <td class="right sub-header" id="amount-paid">₹0.00</td>
            </tr>
            <tr>
                <td class="sub-header">Change:</td>
                <td class="right sub-header" id="change-amount">₹0.00</td>
            </tr>
        </table>
    </div>
    <div class="line"></div>

    <!-- Custom Message -->
    <div class="center footer" id="custom-message">
        Exchange policy: 7 days with bill
    </div>

    <!-- Footer Image -->
    <div class="footer-image" id="footer-image-container" style="display: none;">
        <img id="footer-image" src="" style="width: 30px; height: 15px;" />
    </div>

    <!-- Footer Text -->
    <div class="center">
        <div class="footer" id="footer-text">Thank you for shopping!</div>
        <div class="footer">Visit again soon!</div>
        <div class="small">Powered by Sharma POS System</div>
    </div>

    <!-- JavaScript for dynamic content -->
    <script>
        // Functions to update receipt content dynamically
        
        function updateShopDetails(shopData) {
            document.getElementById('shop-name').textContent = shopData.name || 'SHARMA SHOE PALACE';
            document.getElementById('shop-address').innerHTML = shopData.address || 'Shop Address';
            document.getElementById('shop-contact').textContent = `Ph: ${shopData.phone || '+91 98765 43210'}`;
            document.getElementById('shop-email').textContent = `Email: ${shopData.email || 'info@sharmashoes.com'}`;
            if (shopData.gstNumber) {
                document.getElementById('shop-gst').textContent = `GSTIN: ${shopData.gstNumber}`;
            }
        }
        
        function updateBillDetails(billData) {
            document.getElementById('bill-number').textContent = billData.billNumber || 'INV123456';
            document.getElementById('bill-date').textContent = billData.date || new Date().toLocaleString('en-IN');
            document.getElementById('cashier-name').textContent = billData.cashier || 'Admin';
        }
        
        function updateItems(items) {
            const itemsList = document.getElementById('items-list');
            itemsList.innerHTML = '';
            
            items.forEach(item => {
                const row = document.createElement('tr');
                row.className = 'item-row';
                row.innerHTML = `
                    <td class="sub-header">${item.name}${item.size ? ` (${item.size})` : ''}</td>
                    <td class="center sub-header">${item.quantity}</td>
                    <td class="right sub-header">₹${item.price.toFixed(2)}</td>
                    <td class="right sub-header">₹${(item.price * item.quantity).toFixed(2)}</td>
                `;
                itemsList.appendChild(row);
                
                // Add discount row if applicable
                if (item.discount > 0) {
                    const discountAmount = item.discountType === 'percentage' 
                        ? (item.price * item.quantity * item.discount / 100)
                        : item.discount;
                    
                    const discountRow = document.createElement('tr');
                    discountRow.innerHTML = `
                        <td colspan="3" class="sub-header discount-text">Discount (${item.discountType === 'percentage' ? item.discount + '%' : '₹' + item.discount})</td>
                        <td class="right sub-header discount-text">-₹${discountAmount.toFixed(2)}</td>
                    `;
                    itemsList.appendChild(discountRow);
                }
            });
        }
        
        function updateTotals(totals) {
            document.getElementById('subtotal').textContent = `₹${totals.subtotal.toFixed(2)}`;
            document.getElementById('after-discount').textContent = `₹${totals.afterDiscount.toFixed(2)}`;
            document.getElementById('cgst-rate').textContent = totals.cgstRate;
            document.getElementById('sgst-rate').textContent = totals.sgstRate;
            document.getElementById('cgst-amount').textContent = `₹${totals.cgst.toFixed(2)}`;
            document.getElementById('sgst-amount').textContent = `₹${totals.sgst.toFixed(2)}`;
            document.getElementById('final-total').textContent = `₹${totals.total.toFixed(2)}`;
            document.getElementById('amount-paid').textContent = `₹${totals.paid.toFixed(2)}`;
            document.getElementById('change-amount').textContent = `₹${totals.change.toFixed(2)}`;
            document.getElementById('payment-method').textContent = totals.paymentMethod || 'Cash';
            
            if (totals.totalDiscount > 0) {
                document.getElementById('total-discount-row').style.display = 'table-row';
                document.getElementById('total-discount').textContent = `-₹${totals.totalDiscount.toFixed(2)}`;
            }
        }
        
        function updateFooter(footerData) {
            if (footerData.customMessage) {
                document.getElementById('custom-message').textContent = footerData.customMessage;
            }
            
            if (footerData.footerText) {
                document.getElementById('footer-text').textContent = footerData.footerText;
            }
            
            if (footerData.footerImage) {
                const container = document.getElementById('footer-image-container');
                const img = document.getElementById('footer-image');
                container.style.display = 'block';
                container.style.textAlign = footerData.imagePosition || 'center';
                img.src = footerData.footerImage;
                img.style.width = `${footerData.imageWidth || 30}px`;
                img.style.height = `${footerData.imageHeight || 15}px`;
            }
        }
        
        // Font customization
        function updateFontSettings(fontSettings) {
            if (fontSettings.fontFamily) {
                document.body.style.fontFamily = fontSettings.fontFamily;
            }
            if (fontSettings.fontSize) {
                document.body.style.fontSize = fontSettings.fontSize;
            }
            if (fontSettings.headerFontSize) {
                document.querySelectorAll('.header').forEach(el => {
                    el.style.fontSize = fontSettings.headerFontSize;
                });
            }
            if (fontSettings.footerFontSize) {
                document.querySelectorAll('.footer').forEach(el => {
                    el.style.fontSize = fontSettings.footerFontSize;
                });
            }
        }
        
        // Print function
        function printReceipt() {
            window.print();
        }
    </script>
</body>
</html>